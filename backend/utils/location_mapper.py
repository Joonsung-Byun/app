from typing import Optional, Dict, Tuple

# =========================================================
# 1. ì§€ì—­ëª… -> (ì‹œë„, ì‹œêµ°êµ¬) ë§¤í•‘ í…Œì´ë¸” (RAG í•„í„°ë§ìš©)
# =========================================================
CITY_TO_PROVINCE_SIGNGU = {
    # --- íŠ¹ë³„ì‹œ / ê´‘ì—­ì‹œ / íŠ¹ë³„ìì¹˜ì‹œ / íŠ¹ë³„ìì¹˜ë„ ---
    "ì„œìš¸": ("ì„œìš¸íŠ¹ë³„ì‹œ",),
    "ê°•ë‚¨êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê°•ë‚¨êµ¬"),
    "ê°•ë™êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê°•ë™êµ¬"),
    "ê°•ë¶êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê°•ë¶êµ¬"),
    "ê°•ì„œêµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê°•ì„œêµ¬"),
    "ê´€ì•…êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê´€ì•…êµ¬"),
    "ê´‘ì§„êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê´‘ì§„êµ¬"),
    "êµ¬ë¡œêµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "êµ¬ë¡œêµ¬"),
    "ê¸ˆì²œêµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê¸ˆì²œêµ¬"),
    "ë…¸ì›êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë…¸ì›êµ¬"),
    "ë„ë´‰êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë„ë´‰êµ¬"),
    "ë™ëŒ€ë¬¸êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë™ëŒ€ë¬¸êµ¬"),
    "ë™ì‘êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë™ì‘êµ¬"),
    "ë§ˆí¬êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë§ˆí¬êµ¬"),
    "ì„œëŒ€ë¬¸êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„œëŒ€ë¬¸êµ¬"),
    "ì„œì´ˆêµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„œì´ˆêµ¬"),
    "ì„±ë™êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„±ë™êµ¬"),
    "ì„±ë¶êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„±ë¶êµ¬"),
    "ì†¡íŒŒêµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì†¡íŒŒêµ¬"),
    "ì–‘ì²œêµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì–‘ì²œêµ¬"),
    "ì˜ë“±í¬êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì˜ë“±í¬êµ¬"),
    "ìš©ì‚°êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ìš©ì‚°êµ¬"),
    "ì€í‰êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì€í‰êµ¬"),
    "ì¢…ë¡œêµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì¢…ë¡œêµ¬"),
    "ì¤‘êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì¤‘êµ¬"),
    "ì¤‘ë‘êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì¤‘ë‘êµ¬"),
    "ë¶€ì‚°": ("ë¶€ì‚°ê´‘ì—­ì‹œ",),
    "ëŒ€êµ¬": ("ëŒ€êµ¬ê´‘ì—­ì‹œ",),
    "ì¸ì²œ": ("ì¸ì²œê´‘ì—­ì‹œ",),
    "ê´‘ì£¼": ("ê´‘ì£¼ê´‘ì—­ì‹œ",),
    "ëŒ€ì „": ("ëŒ€ì „ê´‘ì—­ì‹œ",),
    "ìš¸ì‚°": ("ìš¸ì‚°ê´‘ì—­ì‹œ",),
    "ì„¸ì¢…": ("ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ",),
    "ì œì£¼": ("ì œì£¼íŠ¹ë³„ìì¹˜ë„",),
    "ì œì£¼ë„": ("ì œì£¼íŠ¹ë³„ìì¹˜ë„",),
    
    # -- ì„±ìˆ˜ë™ì´ë‚˜ í•œë‚¨ë™ ê°™ì€ ë™ë„¤ëª… ë§¤í•‘ìš© --
    
    "ê°•ë‚¨": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê°•ë‚¨êµ¬"),
    "ê°•ë¶": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê°•ë¶êµ¬"),
    "ê°•ì„œ": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê°•ì„œêµ¬"),
    "ê´€ì•…": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê´€ì•…êµ¬"),
    "ê´‘ì§„": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê´‘ì§„êµ¬"),
    "êµ¬ë¡œ": ("ì„œìš¸íŠ¹ë³„ì‹œ", "êµ¬ë¡œêµ¬"),
    "ê¸ˆì²œ": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ê¸ˆì²œêµ¬"),
    "ë…¸ì›": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë…¸ì›êµ¬"),
    "ë„ë´‰": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë„ë´‰êµ¬"),
    "ë™ëŒ€ë¬¸": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë™ëŒ€ë¬¸êµ¬"),
    "ë™ì‘": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë™ì‘êµ¬"),
    "ë§ˆí¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ë§ˆí¬êµ¬"),
    "ì„œëŒ€ë¬¸": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„œëŒ€ë¬¸êµ¬"),
    "ì„œì´ˆ": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„œì´ˆêµ¬"),
    "ì„±ë™": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„±ë™êµ¬"),
    "ì„±ë¶": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„±ë¶êµ¬"),
    "ì†¡íŒŒ": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì†¡íŒŒêµ¬"),
    "ì–‘ì²œ": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì–‘ì²œêµ¬"),
    "ì˜ë“±í¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì˜ë“±í¬êµ¬"),
    "ìš©ì‚°": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ìš©ì‚°êµ¬"),
    "ì€í‰": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì€í‰êµ¬"),
    "ì¢…ë¡œ": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì¢…ë¡œêµ¬"),
    "ì¤‘êµ¬": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì¤‘êµ¬"),
    "ì¤‘ë‘": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì¤‘ë‘êµ¬"),
    "ì„±ìˆ˜": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„±ë™êµ¬"),
    "ì„±ìˆ˜ë™": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ì„±ë™êµ¬"),
    "í•œë‚¨": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ìš©ì‚°êµ¬"),
    "ì´íƒœì›": ("ì„œìš¸íŠ¹ë³„ì‹œ", "ìš©ì‚°êµ¬"),
    # --- ì¸ì²œê´‘ì—­ì‹œ ---
    "ê³„ì–‘": ("ì¸ì²œê´‘ì—­ì‹œ", "ê³„ì–‘êµ¬"),
    "ë‚¨ë™": ("ì¸ì²œê´‘ì—­ì‹œ", "ë‚¨ë™êµ¬"),
    "ë™êµ¬": ("ì¸ì²œê´‘ì—­ì‹œ", "ë™êµ¬"),
    "ë¯¸ì¶”í™€": ("ì¸ì²œê´‘ì—­ì‹œ", "ë¯¸ì¶”í™€êµ¬"),
    "ë¶€í‰": ("ì¸ì²œê´‘ì—­ì‹œ", "ë¶€í‰êµ¬"),
    "ì„œêµ¬": ("ì¸ì²œê´‘ì—­ì‹œ", "ì„œêµ¬"),
    "ì—°ìˆ˜": ("ì¸ì²œê´‘ì—­ì‹œ", "ì—°ìˆ˜êµ¬"),
    "ì¤‘êµ¬": ("ì¸ì²œê´‘ì—­ì‹œ", "ì¤‘êµ¬"),





    # --- ê²½ê¸°ë„ ---
    "ìˆ˜ì›": ("ê²½ê¸°ë„", "ìˆ˜ì›ì‹œ"),
    "ì„±ë‚¨": ("ê²½ê¸°ë„", "ì„±ë‚¨ì‹œ"),
    "ì˜ì •ë¶€": ("ê²½ê¸°ë„", "ì˜ì •ë¶€ì‹œ"),
    "ì•ˆì–‘": ("ê²½ê¸°ë„", "ì•ˆì–‘ì‹œ"),
    "ë¶€ì²œ": ("ê²½ê¸°ë„", "ë¶€ì²œì‹œ"),
    "ê´‘ëª…": ("ê²½ê¸°ë„", "ê´‘ëª…ì‹œ"),
    "í‰íƒ": ("ê²½ê¸°ë„", "í‰íƒì‹œ"),
    "ë™ë‘ì²œ": ("ê²½ê¸°ë„", "ë™ë‘ì²œì‹œ"),
    "ì•ˆì‚°": ("ê²½ê¸°ë„", "ì•ˆì‚°ì‹œ"),
    "ê³ ì–‘": ("ê²½ê¸°ë„", "ê³ ì–‘ì‹œ"),
    "ê³¼ì²œ": ("ê²½ê¸°ë„", "ê³¼ì²œì‹œ"),
    "êµ¬ë¦¬": ("ê²½ê¸°ë„", "êµ¬ë¦¬ì‹œ"),
    "ë‚¨ì–‘ì£¼": ("ê²½ê¸°ë„", "ë‚¨ì–‘ì£¼ì‹œ"),
    "ì˜¤ì‚°": ("ê²½ê¸°ë„", "ì˜¤ì‚°ì‹œ"),
    "ì‹œí¥": ("ê²½ê¸°ë„", "ì‹œí¥ì‹œ"),
    "êµ°í¬": ("ê²½ê¸°ë„", "êµ°í¬ì‹œ"),
    "ì˜ì™•": ("ê²½ê¸°ë„", "ì˜ì™•ì‹œ"),
    "í•˜ë‚¨": ("ê²½ê¸°ë„", "í•˜ë‚¨ì‹œ"),
    "ìš©ì¸": ("ê²½ê¸°ë„", "ìš©ì¸ì‹œ"),
    "íŒŒì£¼": ("ê²½ê¸°ë„", "íŒŒì£¼ì‹œ"),
    "ì´ì²œ": ("ê²½ê¸°ë„", "ì´ì²œì‹œ"),
    "ì•ˆì„±": ("ê²½ê¸°ë„", "ì•ˆì„±ì‹œ"),
    "ê¹€í¬": ("ê²½ê¸°ë„", "ê¹€í¬ì‹œ"),
    "í™”ì„±": ("ê²½ê¸°ë„", "í™”ì„±ì‹œ"),
    "ê´‘ì£¼": ("ê²½ê¸°ë„", "ê´‘ì£¼ì‹œ"),
    "ì–‘ì£¼": ("ê²½ê¸°ë„", "ì–‘ì£¼ì‹œ"),
    "í¬ì²œ": ("ê²½ê¸°ë„", "í¬ì²œì‹œ"),
    "ì—¬ì£¼": ("ê²½ê¸°ë„", "ì—¬ì£¼ì‹œ"),

    # --- ê°•ì›ë„ ---
    "ì¶˜ì²œ": ("ê°•ì›ë„", "ì¶˜ì²œì‹œ"),
    "ì›ì£¼": ("ê°•ì›ë„", "ì›ì£¼ì‹œ"),
    "ê°•ë¦‰": ("ê°•ì›ë„", "ê°•ë¦‰ì‹œ"),
    "ë™í•´": ("ê°•ì›ë„", "ë™í•´ì‹œ"),
    "ì†ì´ˆ": ("ê°•ì›ë„", "ì†ì´ˆì‹œ"),
    "ì‚¼ì²™": ("ê°•ì›ë„", "ì‚¼ì²™ì‹œ"),
    "íƒœë°±": ("ê°•ì›ë„", "íƒœë°±ì‹œ"),

    # --- ì¶©ì²­ë¶ë„ ---
    "ì²­ì£¼": ("ì¶©ì²­ë¶ë„", "ì²­ì£¼ì‹œ"),
    "ì¶©ì£¼": ("ì¶©ì²­ë¶ë„", "ì¶©ì£¼ì‹œ"),
    "ì œì²œ": ("ì¶©ì²­ë¶ë„", "ì œì²œì‹œ"),

    # --- ì¶©ì²­ë‚¨ë„ ---
    "ì²œì•ˆ": ("ì¶©ì²­ë‚¨ë„", "ì²œì•ˆì‹œ"),
    "ê³µì£¼": ("ì¶©ì²­ë‚¨ë„", "ê³µì£¼ì‹œ"),
    "ë³´ë ¹": ("ì¶©ì²­ë‚¨ë„", "ë³´ë ¹ì‹œ"),
    "ì•„ì‚°": ("ì¶©ì²­ë‚¨ë„", "ì•„ì‚°ì‹œ"),
    "ì„œì‚°": ("ì¶©ì²­ë‚¨ë„", "ì„œì‚°ì‹œ"),
    "ë…¼ì‚°": ("ì¶©ì²­ë‚¨ë„", "ë…¼ì‚°ì‹œ"),
    "ê³„ë£¡": ("ì¶©ì²­ë‚¨ë„", "ê³„ë£¡ì‹œ"),
    "ë‹¹ì§„": ("ì¶©ì²­ë‚¨ë„", "ë‹¹ì§„ì‹œ"),

    # --- ì „ë¼ë¶ë„ ---
    "ì „ì£¼": ("ì „ë¼ë¶ë„", "ì „ì£¼ì‹œ"),
    "ìµì‚°": ("ì „ë¼ë¶ë„", "ìµì‚°ì‹œ"),
    "êµ°ì‚°": ("ì „ë¼ë¶ë„", "êµ°ì‚°ì‹œ"),
    "ì •ì": ("ì „ë¼ë¶ë„", "ì •ìì‹œ"),
    "ë‚¨ì›": ("ì „ë¼ë¶ë„", "ë‚¨ì›ì‹œ"),
    "ê¹€ì œ": ("ì „ë¼ë¶ë„", "ê¹€ì œì‹œ"),

    # --- ì „ë¼ë‚¨ë„ ---
    "ëª©í¬": ("ì „ë¼ë‚¨ë„", "ëª©í¬ì‹œ"),
    "ì—¬ìˆ˜": ("ì „ë¼ë‚¨ë„", "ì—¬ìˆ˜ì‹œ"),
    "ìˆœì²œ": ("ì „ë¼ë‚¨ë„", "ìˆœì²œì‹œ"),
    "ë‚˜ì£¼": ("ì „ë¼ë‚¨ë„", "ë‚˜ì£¼ì‹œ"),
    "ê´‘ì–‘": ("ì „ë¼ë‚¨ë„", "ê´‘ì–‘ì‹œ"),
    "ì‹ ì•ˆ": ("ì „ë¼ë‚¨ë„", "ì‹ ì•ˆêµ°"),

    # --- ê²½ìƒë¶ë„ ---
    "í¬í•­": ("ê²½ìƒë¶ë„", "í¬í•­ì‹œ"),
    "ê²½ì£¼": ("ê²½ìƒë¶ë„", "ê²½ì£¼ì‹œ"),
    "ê¹€ì²œ": ("ê²½ìƒë¶ë„", "ê¹€ì²œì‹œ"),
    "ì•ˆë™": ("ê²½ìƒë¶ë„", "ì•ˆë™ì‹œ"),
    "êµ¬ë¯¸": ("ê²½ìƒë¶ë„", "êµ¬ë¯¸ì‹œ"),
    "ì˜ì£¼": ("ê²½ìƒë¶ë„", "ì˜ì£¼ì‹œ"),
    "ì˜ì²œ": ("ê²½ìƒë¶ë„", "ì˜ì²œì‹œ"),
    "ìƒì£¼": ("ê²½ìƒë¶ë„", "ìƒì£¼ì‹œ"),
    "ë¬¸ê²½": ("ê²½ìƒë¶ë„", "ë¬¸ê²½ì‹œ"),
    "ê²½ì‚°": ("ê²½ìƒë¶ë„", "ê²½ì‚°ì‹œ"),

    # --- ê²½ìƒë‚¨ë„ ---
    "ì°½ì›": ("ê²½ìƒë‚¨ë„", "ì°½ì›ì‹œ"),
    "ì§„ì£¼": ("ê²½ìƒë‚¨ë„", "ì§„ì£¼ì‹œ"),
    "í†µì˜": ("ê²½ìƒë‚¨ë„", "í†µì˜ì‹œ"),
    "ì‚¬ì²œ": ("ê²½ìƒë‚¨ë„", "ì‚¬ì²œì‹œ"),
    "ê¹€í•´": ("ê²½ìƒë‚¨ë„", "ê¹€í•´ì‹œ"),
    "ë°€ì–‘": ("ê²½ìƒë‚¨ë„", "ë°€ì–‘ì‹œ"),
    "ê±°ì œ": ("ê²½ìƒë‚¨ë„", "ê±°ì œì‹œ"),
    "ì–‘ì‚°": ("ê²½ìƒë‚¨ë„", "ì–‘ì‚°ì‹œ"),
}

# =========================================================
# 2. ê¸°ìƒì²­ ì§€ì—­ ì½”ë“œ (ë‚ ì”¨ ì¡°íšŒìš©)
# =========================================================
KMA_LOCATION_CODES = {
    # ìˆ˜ë„ê¶Œ (ì„œìš¸/ì¸ì²œ/ê²½ê¸°)
    "ì„œìš¸": "108", "ì¢…ë¡œ": "108", "ì¤‘êµ¬": "108", "ìš©ì‚°": "108",
    "ì¸ì²œ": "112", "ë¶€ì²œ": "112", "ê¹€í¬": "112",
    "ìˆ˜ì›": "119", "í™”ì„±": "119", "ì˜¤ì‚°": "119",
    "ì„±ë‚¨": "119", "ìš©ì¸": "119", "ì•ˆì–‘": "119", "ê´‘ëª…": "119",
    "íŒŒì£¼": "098", "ê³ ì–‘": "098", "ì–‘ì£¼": "098", "ë™ë‘ì²œ": "098",
    "ê°•í™”": "201", "ì–‘í‰": "202", "ì´ì²œ": "203",
    "í‰íƒ": "119", "ì•ˆì„±": "203", "ì—¬ì£¼": "203",
    "ê°€í‰": "202", "ë‚¨ì–‘ì£¼": "202", "êµ¬ë¦¬": "202", "í•˜ë‚¨": "202",

    # ê°•ì›
    "ì¶˜ì²œ": "101", "í™ì²œ": "101", "í™”ì²œ": "101",
    "ê°•ë¦‰": "105", "ë™í•´": "105", "ì‚¼ì²™": "105",
    "ì†ì´ˆ": "090", "ì–‘ì–‘": "090", "ê³ ì„±": "090",
    "ì›ì£¼": "114", "íš¡ì„±": "114", "ì˜ì›”": "121",
    "íƒœë°±": "216", "ì •ì„ ": "216", "í‰ì°½": "114",
    "ì² ì›": "095", "ì¸ì œ": "095",

    # ì¶©ì²­
    "ëŒ€ì „": "133", "ì„¸ì¢…": "133",
    "ì²­ì£¼": "131", "ì¶©ì£¼": "127", "ì œì²œ": "127",
    "ì²œì•ˆ": "232", "ì•„ì‚°": "232", "ë‹¹ì§„": "232",
    "ë³´ë ¹": "235", "ì„œì‚°": "129", "íƒœì•ˆ": "129",
    "ê³µì£¼": "232", "ë…¼ì‚°": "232", "ê³„ë£¡": "133",
    "ê¸ˆì‚°": "238", "ë¶€ì—¬": "235", "ì„œì²œ": "235",
    "ì²­ì–‘": "235", "í™ì„±": "177", "ì˜ˆì‚°": "232",

    # ê²½ìƒ (ëŒ€êµ¬/ê²½ë¶)
    "ëŒ€êµ¬": "143", "ê²½ì‚°": "143",
    "í¬í•­": "138", "ê²½ì£¼": "283", "ì˜ë•": "277",
    "ì•ˆë™": "136", "ì˜ì£¼": "136", "ë´‰í™”": "136",
    "êµ¬ë¯¸": "279", "ê¹€ì²œ": "279", "ì¹ ê³¡": "143",
    "ìƒì£¼": "279", "ë¬¸ê²½": "273", "ì˜ˆì²œ": "136",
    "ìš¸ì§„": "130", "ì˜ì–‘": "136", "ì²­ì†¡": "143",
    "ì˜ì„±": "278", "êµ°ìœ„": "143",

    # ê²½ìƒ (ë¶€ì‚°/ìš¸ì‚°/ê²½ë‚¨)
    "ë¶€ì‚°": "159", "ê¸°ì¥": "159",
    "ìš¸ì‚°": "152",
    "ì°½ì›": "155", "ê¹€í•´": "159", "ì–‘ì‚°": "159",
    "ì§„ì£¼": "192", "ê±°ì œ": "294", "í†µì˜": "162",
    "ì‚¬ì²œ": "192", "ë°€ì–‘": "253", "í•¨ì•ˆ": "155",
    "ê±°ì°½": "284", "í•©ì²œ": "285", "ì°½ë…•": "155",
    "ê³ ì„±": "162", "ë‚¨í•´": "295", "í•˜ë™": "192",
    "ì‚°ì²­": "192", "í•¨ì–‘": "184", "ì˜ë ¹": "192",

    # ì „ë¼ (ê´‘ì£¼/ì „ë‚¨)
    "ê´‘ì£¼": "156", "ë‚˜ì£¼": "167", "í™”ìˆœ": "156",
    "ëª©í¬": "165", "ë¬´ì•ˆ": "165", "ì˜ì•”": "165",
    "ì—¬ìˆ˜": "168", "ìˆœì²œ": "174", "ê´‘ì–‘": "168",
    "ê³ í¥": "170", "ë³´ì„±": "168", "ì¥í¥": "169",
    "ê°•ì§„": "165", "í•´ë‚¨": "169", "ì™„ë„": "170",
    "ì§„ë„": "175", "ì‹ ì•ˆ": "165",
    "ë‹´ì–‘": "172", "ê³¡ì„±": "156", "êµ¬ë¡€": "156",
    "ì¥ì„±": "156", "ì˜ê´‘": "252",

    # ì „ë¼ (ì „ë¶)
    "ì „ì£¼": "146", "ìµì‚°": "146", "ê¹€ì œ": "146",
    "êµ°ì‚°": "140", "ì •ì": "251", "ë‚¨ì›": "247",
    "ê³ ì°½": "251", "ë¶€ì•ˆ": "243",
    "ì™„ì£¼": "146", "ì§„ì•ˆ": "248", "ë¬´ì£¼": "248",
    "ì¥ìˆ˜": "248", "ì„ì‹¤": "247", "ìˆœì°½": "254",

    # ì œì£¼
    "ì œì£¼": "184", "ì œì£¼ì‹œ": "184",
    "ì„œê·€í¬": "189", "ì„±ì‚°": "188", "ì• ì›”": "184",
    "ì¡°ì²œ": "184", "í•œë¦¼": "184", "ë‚¨ì›": "189",
    "í‘œì„ ": "188", "ì•ˆë•": "189", "ëŒ€ì •": "189"
}

# =========================================================
# 3. ìƒì„¸ ì§€ëª… -> ëŒ€í‘œ ë„ì‹œ ë§¤í•‘ (ë™ -> ì‹œ)
# =========================================================
DONG_TO_CITY = {
    # ì„œìš¸ (ì£¼ìš” ë™ë§Œ ì„ ë³„)
    "ëª…ë™": "ì„œìš¸", "ì¢…ë¡œ": "ì„œìš¸", "ì„ì§€ë¡œ": "ì„œìš¸", "ê´‘í™”ë¬¸": "ì„œìš¸",
    "ê°•ë‚¨": "ì„œìš¸", "ì—­ì‚¼ë™": "ì„œìš¸", "ì‚¼ì„±ë™": "ì„œìš¸", "ë…¼í˜„ë™": "ì„œìš¸",
    "ì••êµ¬ì •": "ì„œìš¸", "ì²­ë‹´": "ì„œìš¸", "ì‹ ì‚¬": "ì„œìš¸", "ë„ì‚°": "ì„œìš¸",
    "ì„œì´ˆ": "ì„œìš¸", "ë°˜í¬": "ì„œìš¸", "ë°©ë°°": "ì„œìš¸", "ì–‘ì¬": "ì„œìš¸",
    "ì ì‹¤": "ì„œìš¸", "ì†¡íŒŒ": "ì„œìš¸", "ê°€ë½": "ì„œìš¸", "ë¬¸ì •": "ì„œìš¸",
    "ì—¬ì˜ë„": "ì„œìš¸", "ì˜ë“±í¬": "ì„œìš¸", "ì‹ ë¦¼": "ì„œìš¸", "êµ¬ë¡œ": "ì„œìš¸",
    "í™ëŒ€": "ì„œìš¸", "ì‹ ì´Œ": "ì„œìš¸", "ì—°ë‚¨": "ì„œìš¸", "ë§ì›": "ì„œìš¸",
    "ì´íƒœì›": "ì„œìš¸", "í•œë‚¨": "ì„œìš¸", "ì„±ìˆ˜": "ì„œìš¸", "ì™•ì‹­ë¦¬": "ì„œìš¸",
    "ê±´ëŒ€": "ì„œìš¸", "ìì–‘": "ì„œìš¸", "ì„±ë™": "ì„œìš¸",
    "ë…¸ì›": "ì„œìš¸", "ì¤‘ê³„": "ì„œìš¸", "ìƒê³„": "ì„œìš¸", "ë„ë´‰": "ì„œìš¸",
    "ëª©ë™": "ì„œìš¸", "ë“±ì´Œ": "ì„œìš¸", "í™”ê³¡": "ì„œìš¸",
    "ê°•ì„œ": "ì„œìš¸", "ì—¼ì°½": "ì„œìš¸", "ë°œì‚°": "ì„œìš¸",

    # ì¸ì²œ
    "ì†¡ë„": "ì¸ì²œ", "ì—°ìˆ˜": "ì¸ì²œ", "êµ¬ì›”": "ì¸ì²œ", "ë¶€í‰": "ì¸ì²œ",
    "ê³„ì–‘": "ì¸ì²œ", "ì²­ë¼": "ì¸ì²œ", "ê²€ë‹¨": "ì¸ì²œ", "ì˜ì¢…": "ì¸ì²œ",
    "ì¤‘êµ¬": "ì¸ì²œ", "ë™ì¸ì²œ": "ì¸ì²œ", "ì£¼ì•ˆ": "ì¸ì²œ",

    # ìˆ˜ì›/ì„±ë‚¨/ìš©ì¸ ë“± ê²½ê¸° ë‚¨ë¶€
    "ì •ìë™": "ìˆ˜ì›", "ì˜í†µ": "ìˆ˜ì›", "ë§¤íƒ„": "ìˆ˜ì›", "ê¶Œì„ ": "ìˆ˜ì›",
    "ì¥ì•ˆ": "ìˆ˜ì›", "íŒ”ë‹¬": "ìˆ˜ì›", "ì¸ê³„": "ìˆ˜ì›",
    "ë¶„ë‹¹": "ì„±ë‚¨", "íŒêµ": "ì„±ë‚¨", "ì•¼íƒ‘": "ì„±ë‚¨", "ìˆ˜ë‚´": "ì„±ë‚¨",
    "ì„œí˜„": "ì„±ë‚¨", "ì´ë§¤": "ì„±ë‚¨", "ì •ì": "ì„±ë‚¨", "ìˆ˜ì •": "ì„±ë‚¨",
    "ì£½ì „": "ìš©ì¸", "ê¸°í¥": "ìš©ì¸", "ìˆ˜ì§€": "ìš©ì¸", "êµ¬ì„±": "ìš©ì¸",
    "ë™ì²œ": "ìš©ì¸", "ë³´ì •": "ìš©ì¸",
    "í‰ì´Œ": "ì•ˆì–‘", "ë²”ê³„": "ì•ˆì–‘", "ì¸ë•ì›": "ì•ˆì–‘",
    "ì‚°ë³¸": "ì•ˆì–‘", "ì¤‘ì•™": "ì•ˆì–‘",

    # ê²½ê¸° ë¶ë¶€
    "ì¼ì‚°": "ê³ ì–‘", "íƒ„í˜„": "ê³ ì–‘", "ë°±ì„": "ê³ ì–‘", "ëŒ€í™”": "ê³ ì–‘",
    "ì£¼ì—½": "ê³ ì–‘", "ì •ë°œì‚°": "ê³ ì–‘", "ë§ˆë‘": "ê³ ì–‘",
    "ìš´ì •": "íŒŒì£¼", "ê¸ˆì´Œ": "íŒŒì£¼", "ë¬¸ì‚°": "íŒŒì£¼",
    "ë³„ë‚´": "ë‚¨ì–‘ì£¼", "ë‹¤ì‚°": "ë‚¨ì–‘ì£¼", "ì§„ì ‘": "ë‚¨ì–‘ì£¼", "í™”ë„": "ë‚¨ì–‘ì£¼",
    "êµë¬¸": "ë‚¨ì–‘ì£¼", "ì˜¤ë‚¨": "ë‚¨ì–‘ì£¼",

    # ë¶€ì‚°
    "í•´ìš´ëŒ€": "ë¶€ì‚°", "ë§ˆë¦°ì‹œí‹°": "ë¶€ì‚°", "ì„¼í…€": "ë¶€ì‚°", "ì¬ì†¡": "ë¶€ì‚°",
    "ê´‘ì•ˆ": "ë¶€ì‚°", "ë‚¨ì²œ": "ë¶€ì‚°", "ìˆ˜ì˜": "ë¶€ì‚°", "ë¯¼ë½": "ë¶€ì‚°",
    "ì„œë©´": "ë¶€ì‚°", "ì „í¬": "ë¶€ì‚°", "ë²”ì¼": "ë¶€ì‚°", "ì¢Œì²œ": "ë¶€ì‚°",
    "ë‚¨í¬": "ë¶€ì‚°", "ìê°ˆì¹˜": "ë¶€ì‚°", "êµ­ì œì‹œì¥": "ë¶€ì‚°", "ê´‘ë³µ": "ë¶€ì‚°",
    "ë¶€ì‚°ì—­": "ë¶€ì‚°", "ì´ˆëŸ‰": "ë¶€ì‚°", "ë™ë˜": "ë¶€ì‚°", "ì˜¨ì²œ": "ë¶€ì‚°",
    "ì‚¬ìƒ": "ë¶€ì‚°", "ë•ì²œ": "ë¶€ì‚°", "í™”ëª…": "ë¶€ì‚°", "êµ¬í¬": "ë¶€ì‚°",
    "ì—°ì‚°": "ë¶€ì‚°", "ê±°ì œ": "ë¶€ì‚°", "ë‹¹ê°": "ë¶€ì‚°",

    # ëŒ€êµ¬
    "ë™ì„±ë¡œ": "ëŒ€êµ¬", "ì¤‘ì•™ë¡œ": "ëŒ€êµ¬", "ë°˜ì›”ë‹¹": "ëŒ€êµ¬", "ëª…ë•": "ëŒ€êµ¬",
    "ìˆ˜ì„±": "ëŒ€êµ¬", "ë²”ì–´": "ëŒ€êµ¬", "ë§Œì´Œ": "ëŒ€êµ¬", "í™©ê¸ˆ": "ëŒ€êµ¬",
    "ì¹ ì„±": "ëŒ€êµ¬", "ì¹¨ì‚°": "ëŒ€êµ¬", "ì„±ì„œ": "ëŒ€êµ¬", "ë‹¬ì„œ": "ëŒ€êµ¬",

    # ëŒ€ì „
    "ë‘”ì‚°": "ëŒ€ì „", "íƒ„ë°©": "ëŒ€ì „", "ìœ ì„±": "ëŒ€ì „", "ê¶ë™": "ëŒ€ì „",
    "ë„ì•ˆ": "ëŒ€ì „", "ë…¸ì€": "ëŒ€ì „", "ê´€í‰": "ëŒ€ì „",
    "ëŒ€ë•": "ëŒ€ì „", "ì‹ íƒ„ì§„": "ëŒ€ì „",

    # ê´‘ì£¼
    "ì¶©ì¥ë¡œ": "ê´‘ì£¼", "ê¸ˆë‚¨ë¡œ": "ê´‘ì£¼", "ìˆ˜ì™„": "ê´‘ì£¼", "ì²¨ë‹¨": "ê´‘ì£¼",
    "ìƒë¬´": "ê´‘ì£¼", "ì¹˜í‰": "ê´‘ì£¼", "í’í–¥": "ê´‘ì£¼",

    # ìš¸ì‚°
    "ì‚¼ì‚°": "ìš¸ì‚°", "ë‹¬ë™": "ìš¸ì‚°", "ì•¼ìŒ": "ìš¸ì‚°", "ì„±ë‚¨": "ìš¸ì‚°",
    "íƒœí™”": "ìš¸ì‚°", "ì¤‘êµ¬": "ìš¸ì‚°",

    # ì œì£¼
    "ë…¸í˜•": "ì œì£¼", "ì—°ë™": "ì œì£¼", "ì´ë„": "ì œì£¼", "ì‚¼ë„": "ì œì£¼",
    "ì¤‘ë¬¸": "ì„œê·€í¬", "ìƒ‰ë‹¬": "ì„œê·€í¬", "ê°•ì •": "ì„œê·€í¬",
}

# =========================================================
# 4. ëª…ì†Œ/ëœë“œë§ˆí¬ -> ëŒ€í‘œ ë„ì‹œ ë§¤í•‘
# =========================================================
LANDMARK_TO_CITY = {
    # ì„œìš¸ ëœë“œë§ˆí¬
    "ë‚¨ì‚°": "ì„œìš¸", "ë‚¨ì‚°íƒ€ì›Œ": "ì„œìš¸", "Nì„œìš¸íƒ€ì›Œ": "ì„œìš¸",
    "ê²½ë³µê¶": "ì„œìš¸", "ì°½ë•ê¶": "ì„œìš¸", "ë•ìˆ˜ê¶": "ì„œìš¸", "ê²½í¬ê¶": "ì„œìš¸",
    "í•œê°•": "ì„œìš¸", "í•œê°•ê³µì›": "ì„œìš¸", "ëšì„¬": "ì„œìš¸", "ì—¬ì˜ë„ê³µì›": "ì„œìš¸",
    "ì²­ê³„ì²œ": "ì„œìš¸", "ê´‘í™”ë¬¸ê´‘ì¥": "ì„œìš¸", "ì„œìš¸ê´‘ì¥": "ì„œìš¸",
    "ë™ëŒ€ë¬¸": "ì„œìš¸", "DDP": "ì„œìš¸", "ë™ëŒ€ë¬¸ë””ìì¸í”Œë¼ì": "ì„œìš¸",
    "ëª…ë™ì„±ë‹¹": "ì„œìš¸", "ë‚¨ëŒ€ë¬¸ì‹œì¥": "ì„œìš¸", "ë¶ì´Œí•œì˜¥ë§ˆì„": "ì„œìš¸",
    "ì¸ì‚¬ë™": "ì„œìš¸", "ì‚¼ì²­ë™": "ì„œìš¸", "ì´í™”ë§ˆì„": "ì„œìš¸",
    "ì½”ì—‘ìŠ¤": "ì„œìš¸", "ì ì‹¤ë¡¯ë°ì›”ë“œ": "ì„œìš¸", "ë¡¯ë°ì›”ë“œíƒ€ì›Œ": "ì„œìš¸",
    "ì˜¬ë¦¼í”½ê³µì›": "ì„œìš¸", "ì„œìš¸ìˆ²": "ì„œìš¸", "ì„ ìœ ë„": "ì„œìš¸",
    "í™ëŒ€ì…êµ¬": "ì„œìš¸", "ì´íƒœì›ê±°ë¦¬": "ì„œìš¸", "ê°€ë¡œìˆ˜ê¸¸": "ì„œìš¸",
    "ê´‘ì¥ì‹œì¥": "ì„œìš¸", "ë™ë¬˜ì•": "ì„œìš¸", "ì„œìš¸ì—­": "ì„œìš¸", "ë¡¯ë°ì›”ë“œ": "ì„œìš¸",


    # ì¸ì²œ
    "ì¸ì²œê³µí•­": "ì¸ì²œ", "ì¸ì²œêµ­ì œê³µí•­": "ì¸ì²œ",
    "ì›”ë¯¸ë„": "ì¸ì²œ", "ì°¨ì´ë‚˜íƒ€ìš´": "ì¸ì²œ", "ì†¡ë„ì„¼íŠ¸ëŸ´íŒŒí¬": "ì¸ì²œ",
    "ì„ì™•ë¦¬í•´ìˆ˜ìš•ì¥": "ì¸ì²œ", "ì˜ì¢…ë„": "ì¸ì²œ",

    # ê²½ê¸°ë„
    "ì—ë²„ëœë“œ": "ìš©ì¸", "í•œêµ­ë¯¼ì†ì´Œ": "ìš©ì¸", "ìºë¦¬ë¹„ì•ˆë² ì´": "ìš©ì¸",
    "ìˆ˜ì›í™”ì„±": "ìˆ˜ì›", "í™”ì„±í–‰ê¶": "ìˆ˜ì›",
    "ê´‘ëª…ë™êµ´": "ê´‘ëª…", "ì•„ì¹¨ê³ ìš”ìˆ˜ëª©ì›": "ê°€í‰",
    "ì˜ë í”„ë‘ìŠ¤": "ê°€í‰", "ë‚¨ì´ì„¬": "ê°€í‰", "ìë¼ì„¬": "ê°€í‰",
    "íŒŒì£¼ DMZ": "íŒŒì£¼", "íŒë¬¸ì ": "íŒŒì£¼", "í—¤ì´ë¦¬ì˜ˆìˆ ë§ˆì„": "íŒŒì£¼",

    # ê°•ì›ë„
    "ì„¤ì•…ì‚°": "ì†ì´ˆ", "ë‚™ì‚°ì‚¬": "ì–‘ì–‘", "ë‚™ì‚°í•´ìˆ˜ìš•ì¥": "ì–‘ì–‘",
    "ê²½í¬ëŒ€": "ê°•ë¦‰", "ê²½í¬í•´ë³€": "ê°•ë¦‰", "ì •ë™ì§„": "ê°•ë¦‰",
    "ì˜¤ì£½í—Œ": "ê°•ë¦‰", "ì£¼ë¬¸ì§„": "ê°•ë¦‰",
    "ëŒ€ê´€ë ¹": "í‰ì°½", "í‰ì°½ ì˜¬ë¦¼í”½": "í‰ì°½", "ìš©í‰": "í‰ì°½",
    "ì˜¤ëŒ€ì‚°": "í‰ì°½", "ì†Œì–‘ê°•ëŒ": "ì¶˜ì²œ", "ë‚¨ì´ì„¬": "ì¶˜ì²œ",
    "íƒœë°±ì‚°": "íƒœë°±", "í™©ì§€ì—°ëª»": "íƒœë°±",

    # ì¶©ì²­ë„
    "ëŒ€ì²­í˜¸": "ëŒ€ì „", "ê³„ë£¡ì‚°": "ëŒ€ì „",
    "ì²­ë‚¨ëŒ€": "ì²­ì£¼", "ì†ë¦¬ì‚°": "ì¶©ì£¼",
    "ë°±ì œë¬¸í™”ë‹¨ì§€": "ë¶€ì—¬", "ë¶€ì†Œì‚°ì„±": "ë¶€ì—¬",
    "ë³´ë ¹ë¨¸ë“œì¶•ì œ": "ë³´ë ¹", "ëŒ€ì²œí•´ìˆ˜ìš•ì¥": "ë³´ë ¹",

    # ë¶€ì‚°/ê²½ë‚¨
    "í•´ìš´ëŒ€í•´ìˆ˜ìš•ì¥": "ë¶€ì‚°", "ê´‘ì•ˆë¦¬í•´ìˆ˜ìš•ì¥": "ë¶€ì‚°", "ê´‘ì•ˆëŒ€êµ": "ë¶€ì‚°",
    "íƒœì¢…ëŒ€": "ë¶€ì‚°", "ìš©ë‘ì‚°ê³µì›": "ë¶€ì‚°", "ê°ì²œë¬¸í™”ë§ˆì„": "ë¶€ì‚°",
    "ë¶€ì‚°íƒ€ì›Œ": "ë¶€ì‚°", "ìê°ˆì¹˜ì‹œì¥": "ë¶€ì‚°", "êµ­ì œì‹œì¥": "ë¶€ì‚°",
    "ë™ë°±ì„¬": "ë¶€ì‚°", "ëˆ„ë¦¬ë§ˆë£¨APECí•˜ìš°ìŠ¤": "ë¶€ì‚°", "ì˜¤ë¥™ë„": "ë¶€ì‚°",
    "í†µë„ì‚¬": "ì–‘ì‚°", "í•´ì¸ì‚¬": "í•©ì²œ", "íŒ”ë§ŒëŒ€ì¥ê²½": "í•©ì²œ",
    "ì§„ì£¼ì„±": "ì§„ì£¼", "ê±°ì œë„": "ê±°ì œ", "ì™¸ë„ë³´íƒ€ë‹ˆì•„": "ê±°ì œ",
    "ë‚¨í•´ë…ì¼ë§ˆì„": "ë‚¨í•´", "í†µì˜ì¼€ì´ë¸”ì¹´": "í†µì˜",

    # ëŒ€êµ¬/ê²½ë¶
    "íŒ”ê³µì‚°": "ëŒ€êµ¬", "ë™í™”ì‚¬": "ëŒ€êµ¬",
    "ì²¨ì„±ëŒ€": "ê²½ì£¼", "ë¶ˆêµ­ì‚¬": "ê²½ì£¼", "ì„êµ´ì•”": "ê²½ì£¼",
    "ì•ˆì••ì§€": "ê²½ì£¼", "ëŒ€ë¦‰ì›": "ê²½ì£¼", "í™©ë¦¬ë‹¨ê¸¸": "ê²½ì£¼",
    "í•˜íšŒë§ˆì„": "ì•ˆë™", "ë„ì‚°ì„œì›": "ì•ˆë™", "ë³‘ì‚°ì„œì›": "ì•ˆë™",
    "ì£¼ì™•ì‚°": "ì²­ì†¡", "ì£½ì„œë£¨": "ì˜ì£¼", "ë¶€ì„ì‚¬": "ì˜ì£¼",
    "í¬í•­ í˜¸ë¯¸ê³¶": "í¬í•­", "í˜¸ë¯¸ê³¶": "í¬í•­",

    # ì „ë¼ë„
    "ë¬´ë“±ì‚°": "ê´‘ì£¼", "ì–‘ë¦¼ë™": "ê´‘ì£¼", "í­ê·„ë§ˆì„": "ê´‘ì£¼",
    "ì „ì£¼í•œì˜¥ë§ˆì„": "ì „ì£¼", "ê²½ê¸°ì „": "ì „ì£¼", "ì˜¤ëª©ëŒ€": "ì „ì£¼",
    "ì „ë™ì„±ë‹¹": "ì „ì£¼", "í•œë²½ë‹¹": "ì „ì£¼",
    "ë‚´ì¥ì‚°": "ì •ì", "ë°±ì–‘ì‚¬": "ì •ì",
    "ì„ ìš´ì‚¬": "ê³ ì°½", "ê³ ì°½ìì„±": "ê³ ì°½",
    "ìˆœì²œë§Œ": "ìˆœì²œ", "ìˆœì²œë§Œì •ì›": "ìˆœì²œ", "ë‚™ì•ˆìì„±": "ìˆœì²œ",
    "ì—¬ìˆ˜ì—‘ìŠ¤í¬": "ì—¬ìˆ˜", "ì—¬ìˆ˜ í•´ìƒì¼€ì´ë¸”ì¹´": "ì—¬ìˆ˜", "ì˜¤ë™ë„": "ì—¬ìˆ˜",
    "í–¥ì¼ì•”": "ì—¬ìˆ˜", "ê±°ë¬¸ë„": "ì—¬ìˆ˜",
    "ë‹´ì–‘ì£½ë…¹ì›": "ë‹´ì–‘", "ë©”íƒ€ì„¸ì½°ì´ì•„ê¸¸": "ë‹´ì–‘",

    # ì œì£¼
    "í•œë¼ì‚°": "ì œì£¼", "ì„±ì‚°ì¼ì¶œë´‰": "ì„œê·€í¬", "ìš°ë„": "ì œì£¼",
    "ì„­ì§€ì½”ì§€": "ì„œê·€í¬", "ë§ˆë¼ë„": "ì„œê·€í¬",
    "ì²œì§€ì—°í­í¬": "ì„œê·€í¬", "ì •ë°©í­í¬": "ì„œê·€í¬", "ì²œì œì—°í­í¬": "ì„œê·€í¬",
    "ì£¼ìƒì ˆë¦¬": "ì„œê·€í¬", "ì¤‘ë¬¸í•´ìˆ˜ìš•ì¥": "ì„œê·€í¬",
    "í˜‘ì¬í•´ìˆ˜ìš•ì¥": "ì œì£¼", "í•¨ë•í•´ìˆ˜ìš•ì¥": "ì œì£¼",
    "ë§Œì¥êµ´": "ì œì£¼", "ìš©ë‘ì•”": "ì œì£¼", "ìš©ì—°êµ¬ë¦„ë‹¤ë¦¬": "ì œì£¼",
    "ì œì£¼ì˜¬ë ˆ": "ì œì£¼", "ì˜¤ì„¤ë¡": "ì œì£¼", "ì¹´ë©œë¦¬ì•„í": "ì œì£¼",
}

# =========================================================
# 5. ëŒ€í•™êµ -> ë„ì‹œ ë§¤í•‘
# =========================================================
UNIVERSITY_TO_CITY = {
    # ì„œìš¸
    "ì„œìš¸ëŒ€": "ì„œìš¸", "ì—°ì„¸ëŒ€": "ì„œìš¸", "ê³ ë ¤ëŒ€": "ì„œìš¸",
    "ì´í™”ì—¬ëŒ€": "ì„œìš¸", "ìˆ™ëª…ì—¬ëŒ€": "ì„œìš¸", "ì¤‘ì•™ëŒ€": "ì„œìš¸",
    "ê²½í¬ëŒ€": "ì„œìš¸", "í•œì–‘ëŒ€": "ì„œìš¸", "ê±´êµ­ëŒ€": "ì„œìš¸",
    "ë™êµ­ëŒ€": "ì„œìš¸", "ì„±ê· ê´€ëŒ€": "ì„œìš¸", "í•œêµ­ì™¸ëŒ€": "ì„œìš¸",
    "ì„œìš¸ì‹œë¦½ëŒ€": "ì„œìš¸", "ê´‘ìš´ëŒ€": "ì„œìš¸", "êµ­ë¯¼ëŒ€": "ì„œìš¸",
    "í™ìµëŒ€": "ì„œìš¸", "ìˆ­ì‹¤ëŒ€": "ì„œìš¸", "ì„¸ì¢…ëŒ€": "ì„œìš¸",

    # ì§€ë°© ì£¼ìš” ëŒ€í•™
    "ë¶€ì‚°ëŒ€": "ë¶€ì‚°", "ê²½ì„±ëŒ€": "ë¶€ì‚°", "ë™ì•„ëŒ€": "ë¶€ì‚°",
    "ì¸í•˜ëŒ€": "ì¸ì²œ", "ì¸ì²œëŒ€": "ì¸ì²œ",
    "ê²½ë¶ëŒ€": "ëŒ€êµ¬", "ê³„ëª…ëŒ€": "ëŒ€êµ¬",
    "ì „ë‚¨ëŒ€": "ê´‘ì£¼", "ì¡°ì„ ëŒ€": "ê´‘ì£¼",
    "ì „ë¶ëŒ€": "ì „ì£¼", "ìš°ì„ëŒ€": "ì „ì£¼",
    "ì¶©ë‚¨ëŒ€": "ëŒ€ì „", "í•œë‚¨ëŒ€": "ëŒ€ì „", "KAIST": "ëŒ€ì „",
    "ê°•ì›ëŒ€": "ì¶˜ì²œ", "í•œë¦¼ëŒ€": "ì¶˜ì²œ",
    "ì œì£¼ëŒ€": "ì œì£¼",
}

# =========================================================
# 6. ì£¼ìš” ë„ì‹œì˜ í•˜ìœ„ êµ¬/ë™ ë¦¬ìŠ¤íŠ¸ (ì¶”ê°€ ë§¤í•‘ìš©)
# =========================================================
LOCATION_MAP = {
    "ì„œìš¸": [
        "ê°•ë‚¨", "ì„œì´ˆ", "ì†¡íŒŒ", "ê°•ë™", "ë§ˆí¬", "ìš©ì‚°", "ì„±ë™", "ê´‘ì§„",
        "ì¤‘êµ¬", "ì¢…ë¡œ", "ì€í‰", "ì„œëŒ€ë¬¸", "ë™ëŒ€ë¬¸", "ì„±ë¶", "ê°•ë¶", "ë„ë´‰",
        "ë…¸ì›", "ë™ì‘", "ê´€ì•…", "ê¸ˆì²œ", "êµ¬ë¡œ", "ì˜ë“±í¬", "ì–‘ì²œ", "ê°•ì„œ",
        # ëª…ì†Œ
        "ëª…ë™", "í™ëŒ€", "ì´íƒœì›", "ê°€ë¡œìˆ˜ê¸¸", "ì••êµ¬ì •", "ì²­ë‹´", "í•œë‚¨ë™",
        "ë¶ì´Œí•œì˜¥ë§ˆì„", "ë‚¨ì‚°íƒ€ì›Œ", "ë‚¨ëŒ€ë¬¸ì‹œì¥", "ë™ëŒ€ë¬¸ì‹œì¥", "ê²½ë³µê¶",
        "í•œê°•ê³µì›", "ëšì„¬", "ì—¬ì˜ë„í•œê°•ê³µì›", "ì ì‹¤ë¡¯ë°ì›”ë“œ", "ì ì‹¤ì•¼êµ¬ì¥",
        "ì—°ë‚¨ë™", "ì—°í¬ë™", "ë§ì›ë™", "í•©ì •", "ìƒìˆ˜", "í™ìµëŒ€ì•", "ì„œì´Œ", "ì‚¼ì²­ë™",
        "ë¶ì´Œ", "ì„ì§€ë¡œ", "ì²­ê³„ì²œ", "ê´‘í™”ë¬¸", "ì¢…ê°", "ì²­ì§„ë™", "ì‹ ì‚¬ë™", "ë…¼í˜„ë™",
        "ê°€ë½ì‹œì¥", "ì²­ëŸ‰ë¦¬", "ì™•ì‹­ë¦¬", "ì ì‹¤ìƒˆë‚´", "ê±´ëŒ€ì…êµ¬", "ì„±ìˆ˜", "ëšì„¬ìœ ì›ì§€",
        "ì„œìš¸ìˆ²", "DDP", "ì½”ì—‘ìŠ¤ëª°", "ì˜¬ë¦¼í”½ê³µì›", "ë¡¯ë°íƒ€ì›Œ", "ì ì‹¤í•œê°•ê³µì›", "ì—¬ì˜ë„ê³µì›",
        "ì—¬ì˜ë„IFCëª°", "ì„œìš¸ì—­", "ì„œìš¸ëŒ€ì…êµ¬", "ë‚™ì„±ëŒ€", "ë´‰ì²œë™", "ì‹ ë¦¼", "ì‹ ì´Œ", "ì´ëŒ€",
        "í™ëŒ€ì…êµ¬", "ë§ì›ì‹œì¥", "ë…¸ëŸ‰ì§„ìˆ˜ì‚°ì‹œì¥", "ì„œìš¸ì‹ë¬¼ì›", "í•˜ëŠ˜ê³µì›", "ì›”ë“œì»µê³µì›",
        "ë‚œì§€í•œê°•ê³µì›", "ì„œìš¸ëœë“œ"
    ],

    # ğŸŒŠ ë¶€ì‚°ê´‘ì—­ì‹œ
    "ë¶€ì‚°": [
        "í•´ìš´ëŒ€", "ê´‘ì•ˆë¦¬", "ì„œë©´", "ë‚¨í¬ë™", "ìê°ˆì¹˜ì‹œì¥", "ê°ì²œë¬¸í™”ë§ˆì„",
        "ì†¡ì •í•´ìˆ˜ìš•ì¥", "ë™ë˜", "ì˜¨ì²œì¥", "ê¸°ì¥", "í•´ë™ìš©ê¶ì‚¬", "íƒœì¢…ëŒ€", "ë¶€ì‚°ì—­",
        "ì†¡ë„í•´ìˆ˜ìš•ì¥", "ë‹¤ëŒ€í¬", "ë¯¼ë½ìˆ˜ë³€ê³µì›", "ìˆ˜ì˜ë§Œìš”íŠ¸ê²½ê¸°ì¥", "ì„¼í…€ì‹œí‹°",
        "ë²¡ìŠ¤ì½”", "ë¶€ì‚°ì‹œë¯¼ê³µì›", "ë¶€ì‚°ëŒ€", "ì˜¨ì²œì²œì¹´í˜ê±°ë¦¬", "ë™ë˜ì‹œì¥", "ë¶€ì‚°íƒ€ì›Œ",
        "ì†¡ì •", "ê´‘ì•ˆëŒ€êµ", "êµ­ì œì‹œì¥", "ë¶€ì‚°í•­ëŒ€êµ"
    ],

    # ğŸœ ëŒ€êµ¬ê´‘ì—­ì‹œ
    "ëŒ€êµ¬": [
        "ë™ì„±ë¡œ", "ìˆ˜ì„±ëª»", "ì•ì‚°", "ì„œë¬¸ì‹œì¥", "ëŒ€êµ¬ì—­", "íŒ”ê³µì‚°", "ì¤‘êµ¬", "ìˆ˜ì„±êµ¬",
         "ëŒ€êµ¬ìˆ˜ëª©ì›", "ë‘ë¥˜ê³µì›", "ì•ì‚°ì „ë§ëŒ€", "ë™ì´Œìœ ì›ì§€", "ì„œë¬¸ì‹œì¥ì•¼ì‹œì¥",
        "ëŒ€êµ¬ì‹ ì„¸ê³„ë°±í™”ì ", "ì´ì›”ë“œ", "83íƒ€ì›Œ"
    ],

    # ğŸŒ‰ ì¸ì²œê´‘ì—­ì‹œ
    "ì¸ì²œ": [
        "ì†¡ë„", "ì—°ìˆ˜êµ¬", "ë¯¸ì¶”í™€êµ¬", "ë¶€í‰", "ê³„ì–‘", "ê°•í™”ë„", "ì°¨ì´ë‚˜íƒ€ìš´", "ì›”ë¯¸ë„", "ì˜ì¢…ë„",
        "ì†¡ë„ì„¼íŠ¸ëŸ´íŒŒí¬", "ì¸ì²œëŒ€êµ", "ì†Œë˜í¬êµ¬", "ì„ì™•ë¦¬í•´ìˆ˜ìš•ì¥", "ì˜í¥ë„",
        "ê°•í™”ë„ë§ˆë‹ˆì‚°", "ì°¨ì´ë‚˜íƒ€ìš´", "ì†¡í˜„ì‹œì¥", "ì‹ í¬êµ­ì œì‹œì¥"
    ],

    # ğŸŒ¿ ê´‘ì£¼ê´‘ì—­ì‹œ
    "ê´‘ì£¼": [
        "ì¶©ì¥ë¡œ", "ìƒë¬´ì§€êµ¬", "ì²¨ë‹¨", "ê´‘ì£¼ì—­", "ì†¡ì •ë¦¬", "ë¬´ë“±ì‚°", "ì–‘ë¦¼ë™"
    ],

    # âš™ï¸ ëŒ€ì „ê´‘ì—­ì‹œ
    "ëŒ€ì „": [
        "ìœ ì„±êµ¬", "ì„œêµ¬", "ëŒ€ë•êµ¬", "ì¤‘êµ¬", "ë‘”ì‚°ë™", "ì€í–‰ë™", "ì—‘ìŠ¤í¬ê³¼í•™ê³µì›", "í•œë°­ìˆ˜ëª©ì›"
    ],

    # ğŸ­ ìš¸ì‚°ê´‘ì—­ì‹œ
    "ìš¸ì‚°": [
        "ì‚¼ì‚°ë™", "ì„±ë‚¨ë™", "ìš¸ì‚°ëŒ€ê³µì›", "íƒœí™”ê°•êµ­ê°€ì •ì›", "ê°„ì ˆê³¶", "ì •ìí•´ë³€"
    ],
}

# =========================================================
# 7. ìœ„ì¹˜ ì¶”ì¶œ í•¨ìˆ˜ (extract_user_intent ë“±ì—ì„œ ì‚¬ìš©)
# =========================================================
def extract_location(text: str) -> Optional[str]:
    """
    ì‚¬ìš©ìê°€ ì…ë ¥í•œ í…ìŠ¤íŠ¸ì—ì„œ ë„ì‹œ/êµ¬/ë™/ëª…ì†Œ ë“± ìœ„ì¹˜ë¥¼ ìµœëŒ€í•œ ì •ë°€í•˜ê²Œ ì¸ì‹í•´
    ëŒ€í‘œ ë„ì‹œëª…(ì˜ˆ: ì„œìš¸, ë¶€ì‚°, ì œì£¼ ë“±)ìœ¼ë¡œ ë°˜í™˜.
    """

    text = text.strip().replace(" ", "")  # ê³µë°± ì œê±° (ì˜ˆ: "í•œ ë‚¨ ë™" â†’ "í•œë‚¨ë™")

    # 1ï¸âƒ£ KMA ì§€ì—­ì½”ë“œ ê¸°ë°˜: ë„ì‹œ/êµ°/êµ¬ ë‹¨ìœ„ ì§ì ‘ ë§¤ì¹­
    for city in KMA_LOCATION_CODES.keys():
        if city in text:
            return city

    # 2ï¸âƒ£ DONG_TO_CITY: ë™(æ´) â†’ ë„ì‹œ ë§¤í•‘
    for dong, city in DONG_TO_CITY.items():
        if dong in text:
            return city

    # 3ï¸âƒ£ LANDMARK_TO_CITY: ëª…ì†Œ/ê´€ê´‘ì§€ â†’ ë„ì‹œ ë§¤í•‘
    for landmark, city in LANDMARK_TO_CITY.items():
        if landmark in text:
            return city

    # 4ï¸âƒ£ UNIVERSITY_TO_CITY: ëŒ€í•™êµ â†’ ë„ì‹œ ë§¤í•‘
    for univ, city in UNIVERSITY_TO_CITY.items():
        if univ in text:
            return city

    # 5ï¸âƒ£ LOCATION_MAP: ì¶”ê°€ í™•ì¥ëª…ì†Œ/ìƒê¶Œ ë“±
    for city, names in LOCATION_MAP.items():
        for name in names:
            if name in text:
                return city

    # 6ï¸âƒ£ ë³´ì • ê·œì¹™ (ìì£¼ ë“±ì¥í•˜ëŠ” í‘œí˜„)
    keyword_city_map = {
        "í•œê°•": "ì„œìš¸", "ì²­ê³„ì²œ": "ì„œìš¸", "ë‚¨ì‚°": "ì„œìš¸", "ê´‘ì•ˆë¦¬": "ë¶€ì‚°",
        "ê°ì²œë¬¸í™”ë§ˆì„": "ë¶€ì‚°", "ë‚¨ì´ì„¬": "ê°€í‰", "ì„¤ì•…ì‚°": "ì†ì´ˆ", "ì—ë²„ëœë“œ": "ìš©ì¸",
        "ë¡¯ë°ì›”ë“œ": "ì„œìš¸", "ê²½ì£¼ì›”ë“œ": "ê²½ì£¼", "ì „ì£¼í•œì˜¥ë§ˆì„": "ì „ì£¼",
        "í•œë¼ì‚°": "ì œì£¼", "ì„±ì‹¬ë‹¹": "ëŒ€ì „"
    }
    for kw, city in keyword_city_map.items():
        if kw in text:
            return city

    # 7ï¸âƒ£ íŒ¨í„´ê¸°ë°˜ ì¶”ë¡  (ì˜ˆ: ~ì¹´í˜ê±°ë¦¬, ~í•´ìˆ˜ìš•ì¥, ~ì‹œì¥)
    if "ì¹´í˜ê±°ë¦¬" in text:
        if "ì„±ìˆ˜" in text or "í™ëŒ€" in text or "ì—°ë‚¨" in text:
            return "ì„œìš¸"
        if "ì• ì›”" in text:
            return "ì œì£¼"
        if "ì˜¨ì²œì²œ" in text:
            return "ë¶€ì‚°"
    if "í•´ìˆ˜ìš•ì¥" in text:
        if "ê´‘ì•ˆ" in text or "í•´ìš´ëŒ€" in text or "ì†¡ì •" in text:
            return "ë¶€ì‚°"
        if "í•¨ë•" in text or "í˜‘ì¬" in text:
            return "ì œì£¼"
        if "ë‚™ì‚°" in text or "ê²½í¬" in text:
            return "ê°•ë¦‰"
        if "ëŒ€ì²œ" in text:
            return "ë³´ë ¹"
    if "ì‹œì¥" in text:
        if "ë‚¨ëŒ€ë¬¸" in text or "ê´‘ì¥" in text or "í†µì¸" in text:
            return "ì„œìš¸"
        if "ì„œë¬¸" in text:
            return "ëŒ€êµ¬"
        if "ìê°ˆì¹˜" in text or "êµ­ì œì‹œì¥" in text:
            return "ë¶€ì‚°"

    return None